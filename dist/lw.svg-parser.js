!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("SVGParser",[],e):"object"==typeof exports?exports.SVGParser=e():t.SVGParser=e()}(this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){t.exports=i(2)},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(){function t(e,n){if(i(this,t),this.x=parseFloat(e),this.y=parseFloat(n),isNaN(this.x)||isNaN(this.y))throw console.error("x:",e,"y:",n),new Error("Float value!!!")}return n(t,[{key:"isEqual",value:function(t){return this.x===t.x&&this.y===t.y}}]),t}(),a=function(){function t(e,n){i(this,t),this.points=[],this.length=0}return n(t,[{key:"getPoints",value:function(){return this.points}},{key:"getFlattenPoints",value:function(){var t=[];return this.points.forEach(function(e){return t.push(e.x,e.y)}),t}},{key:"getPoint",value:function(t){return this.points[t<0?this.length+t:t]||null}},{key:"addPoint",value:function(t,e){this.points.push(new r(t,e)),this.length=this.points.length}},{key:"addPoints",value:function(t){for(var e=0,i=t.length;e<i;e+=2)this.addPoint(t[e],t[e+1])}},{key:"isClosed",value:function(){var t=this.getPoint(0);return t&&t.isEqual(this.getPoint(-1))}},{key:"close",value:function(){if(!this.isClosed()&&this.length>2){var t=this.getPoint(0);return this.addPoint(t.x,t.y),!0}return!1}},{key:"transform",value:function(t){this.points=this.points.map(function(e){return new r(t[0]*e.x+t[2]*e.y+t[4],t[1]*e.x+t[3]*e.y+t[5])})}}]),t}();e.Path=a,e.Point=r,e.default=a},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Parser=void 0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(3),s=i(4),o=function(){function t(e){n(this,t),e=e||{},this.element=null,this.editor=null,this.document=null,this.defs=null,this.tags=null,this.traceSettings=Object.assign({linear:!0,step:.01,resolution:100,segmentLength:1},e.traceSettings||{}),this.supportedTags=["svg","g","defs","use","line","polyline","polygon","rect","circle","ellipse","path","title","desc"],this.parseTags=e.includes||this.supportedTags,this.skipTags=e.excludes||["#text","#comment"],e.onTag&&this.onTag(e.onTag,e.onTagContext)}return r(t,[{key:"load",value:function(t){return"string"==typeof t?this.loadFromString(t):t instanceof File?this.loadFromFile(t):t instanceof XMLDocument?this.loadFromXMLDocument(t):t instanceof Element?this.loadFromElement(t):Promise.reject(new Error("Unsupported input format."))}},{key:"loadFromElement",value:function(t){var e=this;return new Promise(function(i,n){t instanceof Element||n(new Error("Input param must be a Element object.")),"parsererror"===t.nodeName&&n(new Error(t.textContent)),"html"===t.nodeName&&t.getElementsByTagName("parsererror")&&n(new Error(t.getElementsByTagName("parsererror")[0].textContent)),e.element=t,i(t)})}},{key:"loadFromXMLDocument",value:function(t){var e=this;return new Promise(function(i,n){t instanceof XMLDocument||n(new Error("Input param must be a XMLDocument object.")),e.loadFromElement(t.documentElement).then(i).catch(n)})}},{key:"loadFromString",value:function(t){var e=this;return new Promise(function(i,n){"string"!=typeof t&&n(new Error("Input param must be a string.")),e._parseEditor(t);var r=new DOMParser,a=r.parseFromString(t,"text/xml");e.loadFromXMLDocument(a).then(i).catch(n)})}},{key:"_parseEditor",value:function(t){this.editor={name:"unknown",version:null,fingerprint:null};var e=void 0;return(e=t.match(/<!-- Created with Inkscape .*-->/i))?(this.editor.name="inkscape",this.editor.fingerprint=e[0],this.editor):(e=t.match(/<!-- Generator: Adobe Illustrator ([0-9\.]+), .*-->/i),e?(this.editor.name="illustrator",this.editor.version=e[1],this.editor.fingerprint=e[0],this.editor):this.editor)}},{key:"loadFromFile",value:function(t){var e=this;return new Promise(function(i,n){t instanceof File||n(new Error("Input param must be a File object."));var r=new FileReader;r.onload=function(t){e.loadFromString(t.target.result).then(i).catch(n)},r.onerror=function(e){n(new Error("Error reading file : "+t.name))},r.readAsText(t)})}},{key:"parse",value:function(t){var e=this;return this.document=null,this.defs={},this.tags=null,t?new Promise(function(i,n){e.load(t).then(function(){i(e.parse())}).catch(n)}):new Promise(function(t,i){e.element||i(new Error("No element is loaded, call the load method before.")),e.tags=e._parseElement(e.element),e.tags||i(new Error("No supported tags found.")),e.tags.applyMatrix(),t(e.tags)})}},{key:"_onTag",value:function(t){console.info("onTag:",t)}},{key:"onTag",value:function(t,e){var i=this;this._onTag=function(n){return t.call(e||i,n)}}},{key:"_parseElement",value:function(t,e){var i=this,n=new a.Tag(t,e);if(this.skipTags.indexOf(n.name)!==-1)return null;if(this.parseTags.indexOf(n.name)===-1)return this._skipTag(n,"unsupported");var r=new s.TagParser(n,this);if(!r.parse())return!1;this._onTag(n);var o=void 0;return t.childNodes.forEach(function(t){(o=i._parseElement(t,n))&&n.addChild(o)}),["svg","g"].indexOf(n.name)===-1||n.children.length?n:this._skipTag(n,"empty")}},{key:"_skipTag",value:function(t,e){return console.warn("Skip tag :",e+":",t),!1}},{key:"_skipTagAttr",value:function(t,e,i){return console.warn("Skip tag attribute :",i+":",e,t),!1}}]),t}();e.Parser=o,e.default=o},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Tag=void 0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(1),s=Math.PI/180,o=function(){function t(e,i){var r=this;n(this,t),this.element=e,this.name=e.nodeName.toLowerCase(),this.parent=i||null,this.layer=null,this.attrs={},this.children=[],this.paths=[],this.matrix=null,this.path=new a.Path,this.point=new a.Point(0,0),this.paths.push(this.path),this.setMatrix(this.parent&&this.parent.matrix),!this.parent||"g"!==this.parent.name&&"svg"!==this.parent.name||!function(){r.layer=r.parent.layer;var t=["transform","width","height"];Object.keys(r.parent.attrs).forEach(function(e){t.indexOf(e)===-1&&r.setAttr(e,r.parent.attrs[e])})}()}return r(t,[{key:"setAttr",value:function(t,e){this.attrs[t]=e}},{key:"getAttr",value:function(t,e){return void 0!==this.attrs[t]?this.attrs[t]:void 0!==e?e:null}},{key:"getLayerName",value:function(){if("g"===this.name)return this.getAttr("inkscape:label",this.getAttr("id",null))}},{key:"setLayerName",value:function(t){"g"===this.name&&(this.layer=t||this.getLayerName())}},{key:"addChild",value:function(t){this.children.push(t)}},{key:"clearPath",value:function(){this.path=new a.Path}},{key:"newPath",value:function(){this.path.length>0&&(this.clearPath(),this.paths.push(this.path))}},{key:"closePath",value:function(){return this.path.close()}},{key:"addPoint",value:function(t,e,i){i&&(t+=this.point.x,e+=this.point.y),this.path.addPoint(t,e),this.point=this.path.getPoint(-1)}},{key:"addPoints",value:function(t,e){for(var i=0,n=t.length;i<n;i+=2)this.addPoint(t[i],t[i+1],e)}},{key:"setMatrix",value:function(t){this.matrix=t||[1,0,0,1,0,0]}},{key:"addMatrix",value:function(t){this.matrix=[this.matrix[0]*t[0]+this.matrix[2]*t[1],this.matrix[1]*t[0]+this.matrix[3]*t[1],this.matrix[0]*t[2]+this.matrix[2]*t[3],this.matrix[1]*t[2]+this.matrix[3]*t[3],this.matrix[0]*t[4]+this.matrix[2]*t[5]+this.matrix[4],this.matrix[1]*t[4]+this.matrix[3]*t[5]+this.matrix[5]]}},{key:"translate",value:function(t,e){e=void 0===e?0:e,this.addMatrix([1,0,0,1,t,e])}},{key:"rotate",value:function(t,e,i){t*=s,2==arguments.length&&this.addMatrix([1,0,0,1,e,i]),this.addMatrix([Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0]),2==arguments.length&&this.addMatrix([1,0,0,1,-e,-i])}},{key:"scale",value:function(t,e){e=void 0===e?t:e,this.addMatrix([t,0,0,e,0,0])}},{key:"skewX",value:function(t){this.addMatrix([1,0,Math.tan(t*s),1,0,0])}},{key:"skewY",value:function(t){this.addMatrix([1,Math.tan(t*s),0,1,0,0])}},{key:"applyMatrix",value:function(t){var e=this;t&&this.addMatrix(t),this.paths.forEach(function(t){t.transform(e.matrix)}),this.setMatrix(null),this.children.forEach(function(e){e.applyMatrix(t)})}}]),t}();e.Tag=o,e.default=o},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.TagParser=void 0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(5),s=i(1),o=function(){function t(e,i){n(this,t),this.tag=e,this.parser=i,this.currentCommand=null,this.lastCommand=null,this.pathData=null,this.traceSettings=i.traceSettings}return r(t,[{key:"parse",value:function(){var t=this,e=this["_"+this.tag.name];if(!e||"function"!=typeof e)return this.parser._skipTag(this.tag,"not yet implemented");this._parseTagAttrs();var i=e.call(this);return i&&this.tag.getAttr("fill")&&this.tag.paths[0].length&&!function(){var e=[],i=[];t.tag.paths.forEach(function(n){t.tag.triangles=null,e.push(n.getFlattenPoints()),i.push("["+n.getFlattenPoints().join(",")+"]")})}(),i}},{key:"_parseTagAttrs",value:function(){var t=this,e=this.tag.element.attributes;if(!e)return null;var i=void 0,n=void 0,r=void 0;Object.keys(e).some(function(a){return i=e[a],n=t._normalizeTagAttr(i),n!==!1&&void("style"===i.nodeName?r=n:t.tag.setAttr(i.nodeName,n))}),r&&r.split(";").some(function(e){return e=e.split(":"),e={nodeName:e[0],nodeValue:e[1]},n=t._normalizeTagAttr(e),n!==!1&&void t.tag.setAttr(e.nodeName,n)});var a=["fill","stroke","color"];a.forEach(function(e){"inherit"===t.tag.getAttr(e)&&t.tag.setAttr(e,t.tag.parent.getAttr(e,"none"))}),this._parseViewBoxAttr(),this._parseTransformAttr()}},{key:"_normalizeTagAttr",value:function(t){var e=t.nodeValue.replace(/(\r?\n|\r)+/gm," ").replace(/\s+/gm," ").trim();if(!e.length)return this.parser._skipTagAttr(this.tag,t,"empty");switch(t.nodeName){case"x":case"y":case"x1":case"y1":case"x2":case"y2":case"r":case"rx":case"ry":case"cx":case"cy":case"width":case"height":case"fontSize":case"strokeWidth":e=this._normalizeTagAttrUnit(t);break;case"points":case"viewBox":e=this._normalizeTagAttrPoints(t);break;case"opacity":case"fillOpacity":case"strokeOpacity":e=this._normalizeTagAttrRange(t,0,1);break;case"preserveAspectRatio":e=this._normalizeTagAttrPreserveAspectRatio(t)}return e}},{key:"_normalizeTagAttrUnit",value:function(t){var e=t.nodeValue.toLowerCase(),i=parseFloat(e);return isNaN(i)?this.parser._skipTagAttr(this.tag,t,"only numeric value allowed"):e.indexOf("mm")!==-1?3.5433070869*i:e.indexOf("cm")!==-1?35.433070869*i:e.indexOf("in")!==-1?90*i:e.indexOf("pt")!==-1?1.25*i:e.indexOf("pc")!==-1?15*i:i}},{key:"_normalizeTagAttrPoints",value:function(t){var e=this._parseNumbers(t.nodeValue);return e===!1?this.parser._skipTagAttr(this.tag,t,"only numeric values are allowed"):e.length?e.length%0?this.parser._skipTagAttr(this.tag,t,"the number of points must be even"):e:this.parser._skipTagAttr(this.tag,t,"empty points list")}},{key:"_normalizeTagAttrRange",value:function(t,e,i){var n=t.nodeValue.trim(),r=parseFloat(n);return isNaN(r)?this.parser._skipTagAttr(this.tag,t,"only numeric values are allowed"):r<e||r>i?this.parser._skipTagAttr(this.tag,t,"out of range ["+e+", "+i+"]"):r}},{key:"_parseNumbers",value:function(t){return"string"==typeof t&&(t=t.split(/([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?/g).filter(function(t){return t&&["",","].indexOf(t.trim())===-1})),t=t.map(parseFloat),!t.some(isNaN)&&t}},{key:"_normalizeTagAttrPreserveAspectRatio",value:function(t){var e={defer:!1,align:"none",meet:!0,slice:!1},i=t.nodeValue;return 0===i.indexOf("defer")&&(i=i.substr(6),e.defer=!0),i=i.split(" "),e.align=i[0],e.meet=i[1]||"meet",e.meet="meet"===e.meet,e.slice=!e.meet,e}},{key:"_parseViewBoxAttr",value:function(){var t=this.tag.getAttr("viewBox",null);if(null===t)return null;var e=this.tag.getAttr("width",t[2]),i=this.tag.getAttr("height",t[3]);this.tag.setAttr("width",e),this.tag.setAttr("height",i);var n=e/t[2],r=i/t[3],a=t[0],s=t[1],o=this.tag.getAttr("preserveAspectRatio","meet xMidYMid");if(o){var h=void 0,u=void 0;o.meet?n>r?(n=r,h=t[2]*n):n<r&&(r=n,u=t[3]*r):o.slice&&(n<r?(n=r,h=t[2]*n):n>r&&(r=n,u=t[3]*r)),void 0!==h?"xMidYMid"===o.align?this.tag.translate((e-h)/2,0):"xMaxYMax"===o.align&&this.tag.translate(e-h,0):void 0!==u&&("xMidYMid"===o.align?this.tag.translate(0,(i-u)/2):"xMaxYMax"===o.align&&this.tag.translate(0,i-u))}this.tag.scale(n,r),this.tag.translate(-a,-s)}},{key:"_parseTransformAttr",value:function(){var t=this,e=this.tag.getAttr("transform",null);if(null===e||!e.length)return null;var i=e.split(")");i.pop();var n=void 0,r=void 0,a=void 0;i.some(function(i){if(n=i.split("("),2!==n.length)return t.parser._skipTagAttr(t.tag,e,"malformed");r=n[0].trim();var s=r;"matrix"===s&&(s="addMatrix");var o=t.tag[s];return"function"!=typeof o?t.parser._skipTagAttr(t.tag,e,"unsupported transform type :"+r):(a=n[1].trim(),a=t._parseNumbers(a),a.length?("addMatrix"==s&&(a=[a]),void o.apply(t.tag,a)):t.parser._skipTagAttr(t.tag,e,"malformed transform type :"+r))})}},{key:"_newPath",value:function(){this.tag.newPath()}},{key:"_clearPath",value:function(){this.tag.clearPath()}},{key:"_closePath",value:function(){return this.tag.closePath()}},{key:"_addPoints",value:function(t,e){return t.length?t.length%0?this.parser._skipTag(this.tag,"the number of points must be even"):(e=arguments.length<2&&this.currentCommand.relative,this.tag.addPoints(t,e),!0):this.parser._skipTag(this.tag,"empty points list")}},{key:"_svg",value:function(){if(this.parser.document)return!0;var t=this.tag.getAttr("width"),e=this.tag.getAttr("height");if(!t||t<0||!e||e<0)throw new Error("Invalid document size: "+t+" / "+e);this.parser.document={width:t,height:e};var i=this.tag.getAttr("viewBox",[0,0,t,e]);return this.parser.document.viewBox={x:i[0],y:i[1],width:i[2],height:i[3]},"inkscape"===this.parser.editor.name&&(this.parser.editor.version=this.tag.getAttr("inkscape:version")),!0}},{key:"_title",value:function(){return this.parser.document&&!this.parser.document.title&&(this.parser.document.title=this.tag.element.textContent),!1}},{key:"_desc",value:function(){return this.parser.document&&!this.parser.document.description&&(this.parser.document.description=this.tag.element.textContent),!1}},{key:"_defs",value:function(){var t=this;return this.tag.element.childNodes.forEach(function(e){e.id&&(t.parser.defs[e.id]=e)}),!1}},{key:"_use",value:function(){var t=this.tag.getAttr("xlink:href").replace(/^#/,""),e=this.parser.defs[t];if(!e)return this.parser._skipTag(this.tag,"undefined reference ["+t+"]");var i=this.parser._parseElement(e,this.tag.parent);return i?(i.setMatrix(this.tag.matrix),this.tag.parent.addChild(i),!1):this.parser._skipTag(this.tag,"empty reference ["+t+"]")}},{key:"_g",value:function(){return this.tag.setLayerName(),!0}},{key:"_line",value:function(){return this._path(["M",this.tag.getAttr("x1"),this.tag.getAttr("y1"),"L",this.tag.getAttr("x2"),this.tag.getAttr("y2")])}},{key:"_polyline",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.tag.getAttr("points"),i=["M",e.shift(),e.shift(),"L"];return i=i.concat(e),t&&i.push("Z"),this._path(i)}},{key:"_polygon",value:function(){return this._polyline(!0)}},{key:"_rect",value:function(){var t=this.tag.getAttr("width"),e=this.tag.getAttr("height"),i=this.tag.getAttr("x",0),n=this.tag.getAttr("y",0),r=this.tag.getAttr("rx",null),a=this.tag.getAttr("ry",null);if(!r&&!a)return this._path(["M",i,n,"h",t,"v",e,"h",-t,"z"]);if(null===r&&(r=a),null===a&&(a=r),null===r||null===r||r<0||a<0)return this.parser._skipTag(this.tag,'negative value for "rx/ry" not allowed');r>t/2&&(r=t/2),a>e/2&&(a=e/2);var s=2*r,o=2*a;return this._path(["M",i+r,n,"h",t-s,"c",r,0,r,a,r,a,"v",e-o,"c",0,a,-r,a,-r,a,"h",-t+s,"c",-r,0,-r,-a,-r,-a,"v",-e+o,"c",0,0,0,-a,r,-a,"z"])}},{key:"_circle",value:function(){var t=this.tag.getAttr("r",0);if(t<=0)return!1;var e=this.tag.getAttr("cx",0),i=this.tag.getAttr("cy",0);return this._path(["M",e-t,i,"A",t,t,0,0,0,e,i+t,"A",t,t,0,0,0,e+t,i,"A",t,t,0,0,0,e,i-t,"A",t,t,0,0,0,e-t,i,"Z"])}},{key:"_ellipse",value:function(){var t=this.tag.getAttr("rx",0),e=this.tag.getAttr("ry",0);if(t<=0||e<=0)return!1;var i=this.tag.getAttr("cx",0),n=this.tag.getAttr("cy",0);return this._path(["M",i-t,n,"A",t,e,0,0,0,i,n+e,"A",t,e,0,0,0,i+t,n,"A",t,e,0,0,0,i,n-e,"A",t,e,0,0,0,i-t,n,"Z"])}},{key:"_paths",value:function(t,e,i){if(i.length>e){for(var n=void 0,r=!0;r&&i.length;)n=this["_path"+t],r=n.call(this,i.splice(0,e));return r}return null}},{key:"_path",value:function(t){var e=this;t&&"string"!=typeof t&&(t=t.join(" "));var i=t||this.tag.getAttr("d",null);if(!i)return!1;var n=i.match(/([M|Z|L|H|V|C|S|Q|T|A]+([^M|Z|L|H|V|C|S|Q|T|A]+)?)/gi);if(!n)return this.parser._skipTag(this.tag,'malformed "d" attribute');this.currentCommand={raw:null,type:null,params:null,relative:null},this.lastCommand=this.currentCommand,this.pathData={};var r=null,a=!1;return n.some(function(t){return t=t.trim(),e.currentCommand.raw=t,e.currentCommand.type=t[0].toUpperCase(),e.currentCommand.params=t.substr(1).trim(),e.currentCommand.relative=e.currentCommand.type!==t[0],r=e["_path"+e.currentCommand.type],r&&"function"==typeof r?(e.currentCommand.params=e._parseNumbers(e.currentCommand.params),e.currentCommand.params===!1?(e.parser._skipTag(e.tag,"only numeric values are allowed in ["+e.currentCommand.raw+"]"),a=!0):r.call(e,e.currentCommand.params)?(e.lastCommand={},void Object.keys(e.currentCommand).forEach(function(t){e.lastCommand[t]=e.currentCommand[t]})):a=!0):(e.parser._skipTag(e.tag,"unsupported path command ["+t[0]+"]"),a=!0)}),!a||(this._clearPath(),!1)}},{key:"_pathM",value:function(t){return this._newPath(),this._addPoints(t)}},{key:"_pathZ",value:function(){return this._closePath(),!0}},{key:"_pathL",value:function(t){return this._addPoints(t)}},{key:"_pathH",value:function(t){var e=this;return t.every(function(t){return e._addPoints([t,e.currentCommand.relative?0:e.tag.point.y])})}},{key:"_pathV",value:function(t){var e=this;return t.every(function(t){return e._addPoints([e.currentCommand.relative?0:e.tag.point.x,t])})}},{key:"_pathC",value:function(t){var e=this._paths("C",6,t);if(null!==e)return e;var i=this.tag.point,n=this.currentCommand.relative,r=t[0]+(n?i.x:0),o=t[1]+(n?i.y:0),h=t[2]+(n?i.x:0),u=t[3]+(n?i.y:0),l=t[4]+(n?i.x:0),c=t[5]+(n?i.y:0);this.pathData.x2=h,this.pathData.y2=u;var p=new s.Point(r,o),f=new s.Point(h,u),g=new s.Point(l,c),d=new a.CubicBezier(this.traceSettings),y=d.trace({p1:i,p2:p,p3:f,p4:g});return this._addPoints(y,!1)}},{key:"_pathS",value:function(t){var e=this._paths("S",4,t);if(null!==e)return e;var i=this.tag.point,n=this.currentCommand.relative,r=i.x,o=i.y;"S"!==this.lastCommand.type&&"C"!==this.lastCommand.type||(r-=this.pathData.x2-r,o-=this.pathData.y2-o);var h=t[0]+(n?i.x:0),u=t[1]+(n?i.y:0),l=t[2]+(n?i.x:0),c=t[3]+(n?i.y:0);this.pathData.x2=h,this.pathData.y2=u;var p=new s.Point(r,o),f=new s.Point(h,u),g=new s.Point(l,c),d=new a.CubicBezier(this.traceSettings),y=d.trace({p1:i,p2:p,p3:f,p4:g});return this._addPoints(y,!1)}},{key:"_pathQ",value:function(t){var e=this._paths("Q",4,t);if(null!==e)return e;var i=this.tag.point,n=this.currentCommand.relative,r=t[0]+(n?i.x:0),o=t[1]+(n?i.y:0),h=t[2]+(n?i.x:0),u=t[3]+(n?i.y:0);this.pathData.x1=r,this.pathData.y1=o;var l=new s.Point(r,o),c=new s.Point(h,u),p=new a.QuadricBezier(this.traceSettings),f=p.trace({p1:i,p2:l,p3:c});return this._addPoints(f,!1)}},{key:"_pathT",value:function(t){var e=this._paths("T",2,t);if(null!==e)return e;var i=this.tag.point,n=this.currentCommand.relative,r=i.x,o=i.y;"Q"!==this.lastCommand.type&&"T"!==this.lastCommand.type||(r-=this.pathData.x1-r,o-=this.pathData.y1-o);var h=t[0]+(n?i.x:0),u=t[1]+(n?i.y:0);this.pathData.x1=r,this.pathData.y1=o;var l=new s.Point(r,o),c=new s.Point(h,u),p=new a.QuadricBezier(this.traceSettings),f=p.trace({p1:i,p2:l,p3:c});return this._addPoints(f,!1)}},{key:"_pathA",value:function(t){var e=this._paths("A",7,t);if(null!==e)return e;var i=this.currentCommand.relative,n=this.tag.point,r=t[0],o=t[1],h=t[2],u=!!t[3],l=!!t[4],c=t[5]+(i?n.x:0),p=t[6]+(i?n.y:0),f=new s.Point(c,p),g=new a.Arc(this.traceSettings),d=g.trace({p1:n,rx:r,ry:o,angle:h,large:u,sweep:l,p2:f});return this._addPoints(d,!1)}}]),t}();e.TagParser=o,e.default=o},function(t,e,i){"use strict";function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){return(t%e+e)%e}function o(t,e,i){return Math.min(Math.max(t,e),i)}function h(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function u(t,e){var i=t.x*e.x+t.y*e.y,n=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2)));return(t.x*e.y-t.y*e.x<0?-1:1)*Math.acos(i/n)}Object.defineProperty(e,"__esModule",{value:!0}),e.QuadricBezier=e.CubicBezier=e.Arc=void 0;var l=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var s=r.get;if(void 0!==s)return s.call(n)},c=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),p=i(1),f=2*Math.PI,g=Math.PI/180,d=function(){function t(e){a(this,t),this.path=[],this.linear=!0,this.step=.01,this.resolution=500,this.segmentLength=.1,Object.assign(this,e||{}),this.arcLength=null,this.arcLengthMap=null}return c(t,[{key:"_clearPath",value:function(){this.path=[]}},{key:"getPath",value:function(){return this.path}},{key:"getPointAtT",value:function(t){return new p.Point(0,0)}},{key:"_addPoint",value:function(t){this.path.push(t.x,t.y)}},{key:"_postTrace",value:function(){}},{key:"_approximateLength",value:function(){var t=0,e=[],i=this.getPointAtT(0),n=void 0,r=void 0,a=void 0;for(n=0;n<this.resolution;n++)r=o(n*(1/this.resolution),0,1),a=this.getPointAtT(r),t+=h(i,a),e.push({t:r,arcLength:t}),i=a;a=this.getPointAtT(1),t+=h(i,a),e.push({t:1,arcLength:t}),Object.assign(this,{arcLength:t,arcLengthMap:e})}},{key:"getPointAtU",value:function(t){t=o(t,0,1);var e=t*this.arcLength,i=0,n=0,r=0;return this.arcLengthMap.every(function(t){var a=t.t,s=t.arcLength;if(s>=e){var o=s-e,h=e-n,u=h/(o+h)||0;return i=r+(a-r)*u,!1}return n=s,r=a,!0}),this.getPointAtT(i)}},{key:"trace",value:function(t){Object.assign(this,t||{});var e="getPointAtT",i=this.step;if(this.linear){this._approximateLength();var n=Math.round(this.arcLength/this.segmentLength);e="getPointAtU",i=1/n}this._clearPath();for(var r=0;r<=1;r+=i)this._addPoint(this[e](r));return this._postTrace(),this.getPath()}}]),t}(),y=function(t){function e(){return a(this,e),n(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return r(e,t),c(e,[{key:"init",value:function(t){if(Object.assign(this,t||{}),this.radians=s(this.angle,360)*g,this.p1.x===this.p2.x&&this.p1.y===this.p2.y)return this.path;if(this.rx=Math.abs(this.rx),this.ry=Math.abs(this.ry),0===this.rx||0===this.ry)return this.__addPoint(this.p1),this.__addPoint(this.p2),this.path;var e=(this.p1.x-this.p2.x)/2,i=(this.p1.y-this.p2.y)/2,n={x:Math.cos(this.radians)*e+Math.sin(this.radians)*i,y:-Math.sin(this.radians)*e+Math.cos(this.radians)*i},r=Math.pow(n.x,2)/Math.pow(this.rx,2)+Math.pow(n.y,2)/Math.pow(this.ry,2);r>1&&(this.rx=Math.sqrt(r)*this.rx,this.ry=Math.sqrt(r)*this.ry);var a=Math.pow(this.rx,2)*Math.pow(this.ry,2)-Math.pow(this.rx,2)*Math.pow(n.y,2)-Math.pow(this.ry,2)*Math.pow(n.x,2),o=Math.pow(this.rx,2)*Math.pow(n.y,2)+Math.pow(this.ry,2)*Math.pow(n.x,2),h=a/o;h=h<0?0:h;var l=(this.large!==this.sweep?1:-1)*Math.sqrt(h),c={x:l*(this.rx*n.y/this.ry),y:l*(-(this.ry*n.x)/this.rx)};this.center={x:Math.cos(this.radians)*c.x-Math.sin(this.radians)*c.y+(this.p1.x+this.p2.x)/2,y:Math.sin(this.radians)*c.x+Math.cos(this.radians)*c.y+(this.p1.y+this.p2.y)/2};var p={x:(n.x-c.x)/this.rx,y:(n.y-c.y)/this.ry},d={x:(-n.x-c.x)/this.rx,y:(-n.y-c.y)/this.ry};this.startAngle=u({x:1,y:0},p),this.sweepAngle=u(p,d),!this.sweep&&this.sweepAngle>0?this.sweepAngle-=f:this.sweep&&this.sweepAngle<0&&(this.sweepAngle+=f),this.sweepAngle%=f}},{key:"trace",value:function(t){return this.init(t),l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"trace",this).call(this)}},{key:"getPointAtT",value:function(t){var e=this.startAngle+this.sweepAngle*t,i=this.rx*Math.cos(e),n=this.ry*Math.sin(e);return new p.Point(Math.cos(this.radians)*i-Math.sin(this.radians)*n+this.center.x,Math.sin(this.radians)*i+Math.cos(this.radians)*n+this.center.y)}},{key:"_postTrace",value:function(){this._addPoint(this.p2)}}]),e}(d),v=function(t){function e(){return a(this,e),n(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return r(e,t),c(e,[{key:"_B1",value:function(t){return t*t*t}},{key:"_B2",value:function(t){return 3*t*t*(1-t)}},{key:"_B3",value:function(t){return 3*t*(1-t)*(1-t)}},{key:"_B4",value:function(t){return(1-t)*(1-t)*(1-t)}},{key:"_C1",value:function(t,e,i,n,r){return t*this._B1(r)+e*this._B2(r)+i*this._B3(r)+n*this._B4(r)}},{key:"getPointAtT",value:function(t){return new p.Point(this._C1(this.p1.x,this.p2.x,this.p3.x,this.p4.x,t),this._C1(this.p1.y,this.p2.y,this.p3.y,this.p4.y,t))}},{key:"_addPoint",value:function(t){this.path.unshift(t.x,t.y)}}]),e}(d),m=function(t){function e(){return a(this,e),n(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return r(e,t),c(e,[{key:"_B1",value:function(t){return t*t}},{key:"_B2",value:function(t){return 2*t*(1-t)}},{key:"_B3",value:function(t){return(1-t)*(1-t)}},{key:"_C1",value:function(t,e,i,n){return t*this._B1(n)+e*this._B2(n)+i*this._B3(n)}},{key:"getPointAtT",value:function(t){return new p.Point(this._C1(this.p1.x,this.p2.x,this.p3.x,t),this._C1(this.p1.y,this.p2.y,this.p3.y,t))}},{key:"_addPoint",value:function(t){this.path.unshift(t.x,t.y)}}]),e}(d);e.Arc=y,e.CubicBezier=v,e.QuadricBezier=m}])});
//# sourceMappingURL=lw.svg-parser.js.map